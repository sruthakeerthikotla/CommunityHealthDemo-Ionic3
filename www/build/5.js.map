{"version":3,"sources":["../../src/pages/login/login.module.ts","../../src/pages/parent/parent.ts","../../src/pages/login/login.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAyC;AACO;AACZ;AAUpC,IAAa,eAAe;IAA5B;IAA8B,CAAC;IAAD,sBAAC;AAAD,CAAC;AAAlB,eAAe;IAR3B,uEAAQ,CAAC;QACR,YAAY,EAAE;YACZ,yDAAS;SACV;QACD,OAAO,EAAE;YACP,sEAAe,CAAC,QAAQ,CAAC,yDAAS,CAAC;SACpC;KACF,CAAC;GACW,eAAe,CAAG;AAAH;;;;;;;;;ACZ5B;AAAA;IAKI,oBAAY,QAAe;QACvB,IAAI,CAAC,MAAM,GAAG,QAAQ,CAAC;IAC3B,CAAC;IAED,qCAAgB,GAAhB;QACE,UAAU,CAAC,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC;IACpC,CAAC;IAED,mCAAc,GAAd;QACE,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,qBAAqB,GAAG,UAAU,CAAC,QAAQ,GAAG,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC;QACvF,EAAE,CAAC,SAAS,CAAC,GAAG,CAAC,EAAC,UAAU,EAAE,UAAU,CAAC,QAAQ,EAAE,QAAQ,EAAE,IAAI,CAAC,MAAM,EAAC,CAAC,CAAC;QAC3E,EAAE,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;IACtB,CAAC;IACH,iBAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClBuC;AAC0D;AAEtD;AAC2C;AAEzF;;;;;EAKE;AAMF,IAAa,SAAS;IAAS,6BAAU;IAcvC,mBAAmB,GAAkB,EAAU,QAAkB,EACxD,SAA0B,EACzB,eAA+B,EAC/B,eAAuC;QAHjD,YAIE,kBAAM,OAAO,CAAC,SA+Ef;QAnFkB,SAAG,GAAH,GAAG,CAAe;QAAU,cAAQ,GAAR,QAAQ,CAAU;QACxD,eAAS,GAAT,SAAS,CAAiB;QACzB,qBAAe,GAAf,eAAe,CAAgB;QAC/B,qBAAe,GAAf,eAAe,CAAwB;QAG/C,KAAI,CAAC,YAAY,GAAG,KAAK,CAAC;QAC1B,KAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;QACnB,KAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;QACnB,KAAI,CAAC,UAAU,GAAG,EAAE,CAAC;QACrB,KAAI,CAAC,eAAe,GAAG,KAAK,CAAC;QAC7B,KAAI,CAAC,gBAAgB,GAAG,EAAE,CAAC;QAC3B,KAAI,CAAC,MAAM,GAAG,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE,GAAG,EAAE,WAAW,EAAE,CAAC,CAAC;QAErD,sGAAsG;QACtG,8DAA8D;QAC9D,UAAU,CAAC;YACT,KAAI,CAAC,eAAe,CAAC,wBAAwB,EAAE,CAAC,IAAI,CAClD,UAAC,OAAO;gBACN,KAAI,CAAC,MAAM,CAAC,GAAG,CAAC,wDAAwD,CAAC,CAAC;YAC5E,CAAC,EACD,UAAC,KAAK;gBACJ,KAAI,CAAC,MAAM,CAAC,GAAG,CAAC,qDAAqD,CAAC,CAAC;YACzE,CAAC,CACF,CAAC;QAEJ,CAAC,EAAE,IAAI,CAAC,CAAC;QAET,KAAI,CAAC,gBAAgB,GAAG,EAAE,CAAC,MAAM,CAAC,mCAAmC,CAAC,wBAAwB,CAAC,CAAC;QAEhG,KAAI,CAAC,gBAAgB,CAAC,eAAe,GAAG,UAAC,SAAc;YACrD,KAAI,CAAC,MAAM,CAAC,GAAG,CAAC,sBAAsB,GAAG,SAAS,CAAC,CAAC;YACpD,KAAI,CAAC,YAAY,GAAG,IAAI,CAAC;YACzB,EAAE,CAAC,CAAC,CAAC,KAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,KAAI,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;gBAC7C,KAAI,CAAC,MAAM,CAAC,GAAG,CAAC,gDAAgD,CAAC,CAAC;gBAClE,KAAI,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC;YACvB,CAAC;YACD,EAAE,CAAC,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACvB,KAAI,CAAC,UAAU,GAAG,SAAS,CAAC,QAAQ,GAAG,uBAAuB,GAAG,SAAS,CAAC,iBAAiB,GAAG,GAAG,CAAC;gBACnG,KAAI,CAAC,eAAe,GAAG,KAAK,CAAC;YAC/B,CAAC;QACH,CAAC;QACD,KAAI,CAAC,gBAAgB,CAAC,aAAa,GAAG,UAAC,WAAW;YAChD,KAAI,CAAC,MAAM,CAAC,GAAG,CAAC,0DAA0D,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,CAAC;YAC1G,EAAE,CAAC,CAAC,KAAI,CAAC,eAAe,CAAC,CAAC,CAAC;gBACzB,KAAI,CAAC,GAAG,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;gBAClC,KAAI,CAAC,YAAY,GAAG,KAAK,CAAC;gBAC1B,KAAI,CAAC,eAAe,GAAG,KAAK,CAAC;YAC/B,CAAC;QACH,CAAC;QACD,KAAI,CAAC,gBAAgB,CAAC,aAAa,GAAG,UAAC,KAAK;YAC1C,KAAI,CAAC,UAAU,GAAG,KAAK,CAAC,OAAO,CAAC;YAChC,KAAI,CAAC,YAAY,GAAG,KAAK,CAAC;YAC1B,KAAI,CAAC,eAAe,GAAG,KAAK,CAAC;QAC/B,CAAC;QAGD,KAAI,CAAC,sBAAsB,GAAG,EAAE,CAAC,MAAM,CAAC,mCAAmC,CAAC,qBAAqB,CAAC,CAAC;QACnG,IAAI,uBAAuB,GAAG,KAAI,CAAC,sBAAsB,CAAC;QAC1D,KAAI,CAAC,sBAAsB,CAAC,eAAe,GAAG,UAAC,SAAc;YAC3D,EAAE,CAAC,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACvB,KAAI,CAAC,MAAM,CAAC,KAAK,CAAC,gCAAgC,GAAG,SAAS,CAAC,CAAC;gBAChE,IAAI,KAAK,GAAG,KAAI,CAAC,SAAS,CAAC,MAAM,CAAC,+BAA+B,EAAE,EAAE,SAAS,EAAE,SAAS,EAAE,CAAC,CAAC;gBAC7F,KAAK,CAAC,YAAY,CAAC,gBAAM;oBACvB,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;wBACX,SAAS,CAAC,MAAM,GAAG,MAAM,CAAC;wBAC1B,uBAAuB,CAAC,qBAAqB,CAAC,SAAS,CAAC,CAAC;oBAC3D,CAAC;oBAAC,IAAI,CAAC,CAAC;wBACN,uBAAuB,CAAC,MAAM,EAAE,CAAC;oBACnC,CAAC;gBACH,CAAC,CAAC,CAAC;gBAEH,KAAK,CAAC,OAAO,EAAE,CAAC;YAElB,CAAC;QACH,CAAC;QACD,KAAI,CAAC,sBAAsB,CAAC,aAAa,GAAG,UAAU,KAAK;YACzD,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC,QAAQ,CAAC;QACzC,CAAC;QACD,KAAI,CAAC,sBAAsB,CAAC,aAAa,GAAG,UAAU,WAAW;QAEjE,CAAC;;IAEH,CAAC;IAGD,yBAAK,GAAL;QAAA,iBAgCC;QA/BC,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC;QAC5B,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;QAErB,EAAE,CAAC,MAAM,CAAC,sBAAsB,EAAE,CAAC;QAEnC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,kBAAkB,CAAC,CAAC;QACtC,EAAE,CAAC,CAAC,EAAE,CAAC,MAAM,CAAC,cAAc,EAAE,KAAK,SAAS,CAAC,CAAC,CAAC;YAC7C,IAAI,CAAC,eAAe,CAAC,wBAAwB,EAAE,CAAC,IAAI,CAClD,UAAC,OAAO;gBACN,KAAI,CAAC,GAAG,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;gBAClC,KAAI,CAAC,eAAe,GAAG,KAAK,CAAC;YAC/B,CAAC,EACD,UAAC,KAAK;gBACJ,KAAI,CAAC,GAAG,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;gBAClC,KAAI,CAAC,eAAe,GAAG,KAAK,CAAC;YAC/B,CAAC,CACF;QACH,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,EAAE,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC;gBACtB,IAAI,CAAC,gBAAgB,CAAC,qBAAqB,CAAC,EAAE,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;YACpG,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,sBAAsB,CAAC,KAAK,CAAC,wBAAwB,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,CAAC;qBACzG,IAAI,CAAC,UAAC,QAAQ;oBACb,KAAI,CAAC,MAAM,CAAC,GAAG,CAAC,gDAAgD,GAAG,QAAQ,CAAC,CAAC;gBAC/E,CAAC,EACD,UAAC,KAAK;oBACJ,KAAI,CAAC,MAAM,CAAC,GAAG,CAAC,kCAAkC,CAAC,CAAC;gBACtD,CAAC,CAAC,CAAC;YACP,CAAC;QACH,CAAC;IAEH,CAAC;IAED,mCAAe,GAAf;QACE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;YAAC,MAAM,CAAC;QAErC,IAAI,aAAa,GAAQ,QAAQ,CAAC,aAAa,CAAC;QAChD,EAAE,CAAC,CAAC,aAAa,CAAC,OAAO,IAAI,OAAO,IAAI,aAAa,CAAC,OAAO,IAAI,UAAU,CAAC,CAAC,CAAC;YAC5E,aAAa,CAAC,IAAI,EAAE,CAAC;QACvB,CAAC;IACH,CAAC;IAEH,gBAAC;AAAD,CAAC,CA/I8B,kEAAU,GA+IxC;AA/IY,SAAS;IALrB,wEAAS,EAAE;IACX,wEAAS,CAAC;QACT,WAAW,EAAE,SAAY;OACH;KACvB,CAAC;+EAeiE;QAC7C,sEAAe;QACR,0GAAc;QACd,MAAsB;AA8HlD;SA/IY,SAAS,e","file":"5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { LoginPage } from './login';\n\n@NgModule({\n  declarations: [\n    LoginPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(LoginPage),\n  ],\n})\nexport class LoginPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.module.ts","export class ParentPage {\n  \n    static fromPage: string;\n    toPage: string;\n    \n    constructor(pageName:string) {\n        this.toPage = pageName;\n    }\n  \n    ionViewWillLeave(){\n      ParentPage.fromPage = this.toPage;\n    }\n    \n    onPageDidEnter(){\n      WL.Logger.debug(\"[did enter] from = \" + ParentPage.fromPage + \", to = \" + this.toPage);  \n      WL.Analytics.log({\"fromPage\": ParentPage.fromPage, \"toPage\": this.toPage});\n      WL.Analytics.send();\n    }\n  }\n\n\n// WEBPACK FOOTER //\n// ./src/pages/parent/parent.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, Platform, ModalController, ViewController } from 'ionic-angular';\n\nimport { ParentPage } from '../parent/parent';\nimport { StorageServiceProvider } from '../../providers/storage-service/storage-service';\n\n/*\n  Generated class for the LoginPage page.\n\n  See http://ionicframework.com/docs/v2/components/#navigation for more info on\n  Ionic pages and navigation.\n*/\n@IonicPage()\n@Component({\n  templateUrl: 'login.html',\n  selector: 'page-login'\n})\nexport class LoginPage extends ParentPage {\n\n  data: any;\n  challengeHandler: WL.Client.SecurityCheckChallengeHandler;\n  stepUpChallengeHandler: WL.Client.SecurityCheckChallengeHandler;\n\n  username: string;\n  password: string;\n  loginError: string;\n  stepUpLoginError: string;\n  loginInProgress: boolean;\n  isChallenged: boolean;\n  logger: any;\n\n  constructor(public nav: NavController, private platform: Platform,\n    public modalCtrl: ModalController,\n    private _viewController: ViewController,\n    private _storageService: StorageServiceProvider) {\n    super(\"Login\");\n\n    this.isChallenged = false;\n    this.username = \"\";\n    this.password = \"\";\n    this.loginError = \"\";\n    this.loginInProgress = false;\n    this.stepUpLoginError = \"\";\n    this.logger = WL.Logger.create({ pkg: 'LoginPage' });\n\n    // HACK: During debugging, the jsonstore.js is being loaded after initialization is completed, causing\n    // a null pointer exception during JSONStore initialization.  \n    setTimeout(() => {\n      this._storageService.initializeOfflineStorage().then(\n        (success) => {\n          this.logger.log(\"LoginPage(): Offline storage initialized successfully.\");\n        },\n        (error) => {\n          this.logger.log(\"LoginPage(): Offline storage initialization failed.\");\n        }\n      );\n\n    }, 1000);\n\n    this.challengeHandler = WL.Client.createSecurityCheckChallengeHandler(\"UserLoginSecurityCheck\");\n \n    this.challengeHandler.handleChallenge = (challenge: any) => {\n      this.logger.log(\"Handling challenge: \" + challenge);\n      this.isChallenged = true;\n      if (!this.nav.isActive(this._viewController)) {\n        this.logger.log(\"Authentication required when not on login page\");\n        this.nav.popToRoot();\n      }\n      if (challenge.errorMsg) {\n        this.loginError = challenge.errorMsg + \" (Remaining attemps: \" + challenge.remainingAttempts + \")\";\n        this.loginInProgress = false;\n      }\n    }\n    this.challengeHandler.handleSuccess = (successData) => {\n      this.logger.log(\"Challenge Handler completed successfully: successData = \" + JSON.stringify(successData));\n      if (this.loginInProgress) {\n        this.nav.push('AppointmentsPage');\n        this.isChallenged = false;\n        this.loginInProgress = false;\n      }\n    }\n    this.challengeHandler.handleFailure = (error) => {\n      this.loginError = error.failure;\n      this.isChallenged = false;\n      this.loginInProgress = false;\n    }\n\n\n    this.stepUpChallengeHandler = WL.Client.createSecurityCheckChallengeHandler(\"StepUpSecurityCheck\");\n    let _stepUpChallengeHandler = this.stepUpChallengeHandler;\n    this.stepUpChallengeHandler.handleChallenge = (challenge: any) => {\n      if (challenge.question) {\n        this.logger.debug(\"Handling step up challenge: %o\" + challenge);\n        let modal = this.modalCtrl.create('StepUpAuthenticationModalPage', { challenge: challenge });\n        modal.onDidDismiss(answer => {\n          if (answer) {\n            challenge.answer = answer;\n            _stepUpChallengeHandler.submitChallengeAnswer(challenge);\n          } else {\n            _stepUpChallengeHandler.cancel();\n          }\n        });\n\n        modal.present();\n\n      }\n    }\n    this.stepUpChallengeHandler.handleFailure = function (error) {\n      this.stepUpLoginError = error.errorMsg;\n    }\n    this.stepUpChallengeHandler.handleSuccess = function (successData) {\n\n    }\n\n  }\n\n\n  login() {\n    this.loginInProgress = true;\n    this.loginError = \"\";\n\n    WL.Logger.updateConfigFromServer();\n\n    this.logger.debug(\"Sign in clicked!\");\n    if (WL.Client.getEnvironment() === \"preview\") {\n      this._storageService.initializeOfflineStorage().then(\n        (success) => {\n          this.nav.push('AppointmentsPage');\n          this.loginInProgress = false;\n        },\n        (error) => {\n          this.nav.push('AppointmentsPage');\n          this.loginInProgress = false;\n        }\n      )\n    } else {\n      if (this.isChallenged) {\n        this.challengeHandler.submitChallengeAnswer({ username: this.username, password: this.password });\n      } else {\n        WLAuthorizationManager.login(\"UserLoginSecurityCheck\", { username: this.username, password: this.password })\n          .then((userData) => {\n            this.logger.log(\"LoginPage.login(): Login success. User data = \" + userData);\n          },\n          (error) => {\n            this.logger.log(\"LoginPage.login(): Login failed.\");\n          });\n      }\n    }\n\n  }\n\n  blurActiveInput() {\n    if (!this.platform.is(\"iOS\")) return;\n\n    var activeElement: any = document.activeElement;\n    if (activeElement.tagName == \"INPUT\" || activeElement.tagName == \"TEXTAREA\") {\n      activeElement.blur();\n    }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.ts"],"sourceRoot":""}